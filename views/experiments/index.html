<!-- TODO -->
<!-- sheetrock example -->
<!-- youtube example -->
<!-- calendar example -->

<html>

<head>
    <!-- // maps key : AIzaSyDdkO3Rp47s2wXOYMKUSv3x6hI3O07PdRA -->
    <script src="sheetrock.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDdkO3Rp47s2wXOYMKUSv3x6hI3O07PdRA&libraries=places"></script>
</head>

<body>
    <p> Hi, how are you ? </p>
    <iframe width="400" height="200" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?q=place_id:ChIJvQk0B3a1RIYRWCvtj7ldkLk&key=AIzaSyDdkO3Rp47s2wXOYMKUSv3x6hI3O07PdRA" allowfullscreen> </iframe>
</body>
<script>

 function pullFromTable(doc_url, requirements){

    var filtered_data = null;
    var done = false;

    sheetrock({
        url: doc_url,
        query: "select *",
        callback: placeData
    });

    Array.prototype.clean = function(deleteValue) {
        for (var i = 0; i < this.length; i++) {
            if (this[i] == deleteValue) {
                this.splice(i, 1);
                i--;
            }
        }
        return this;
    };

    function placeData(error, options, response, needed_values) {
        filtered_data = {};

        if (error) {
            console.log('ERROR IN PLACE DATA');
            console.log(error);
        } else {

            var id_num = 0;
            labels = response.rows[0].cellsArray;


            filtered_data = response.rows.map(function(row) {

                dat = row.cellsArray;
                var location_dat = {};
                location_dat['id'] = id_num;

                //map the label to the value
                for(var ind = 0; ind < dat.length; ++ind){
                    location_dat[labels[ind]] = dat[ind];
                }

                //return null for any objects that don't meet the requirements
                var keys = Object.keys(location_dat);
                for (var ind = 0; ind < requirements.length; ++ind) {
                    //If the objects requirement value is null for something that's required..
                    if (!location_dat[requirements[ind]]) {
                        return null;
                    }
                }

                id_num += 1;
                return location_dat;
            });

            filtered_data.clean(null);
            //remove the first element because it's just a bunch of names instead of data. 
            filtered_data.shift();

            //do something with filtered data.
            //hackathons let you commit crimes - (past)Oliver Croomes
            /* console.log('filtered_data');*/
            /* console.log(filtered_data);*/
            done = true;

        }

    }

    return filtered_data;
}

var ourData = pullFromTable('https://docs.google.com/spreadsheets/d/18C24pEmFTz9JhIX_8UUhHEb5GenBPtrW_6WPMP_muzM/edit#gid=0',[]);
console.log('Functino call results');
console.log(ourData);
</script>

</html>
